import smtplib
import ssl
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from dotenv import load_dotenv
import os

load_dotenv()

def send_digest(email):
    server = smtplib.SMTP_SSL(host='smtp.gmail.com', port=465)
    server.login(user=os.getenv('SMTP_USER'),password=os.getenv('SMTP_PASSWORD'))

    html = """\
<html>
   <body>
    <div style="max-width: 670px; background-color: #060B1C; font-family: &quot;Inter&quot;, BlinkMacSystemFont, -apple-system, &quot;Segoe UI&quot;, &quot;Roboto&quot;, &quot;Oxygen&quot;, &quot;Ubuntu&quot;, &quot;Cantarell&quot;, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif !important;">
           <div style="display: flex; justify-content: center;">
               <svg style="width: 12rem; margin-top: 6rem;" viewBox="0 0 155 43" fill="none" xmlns="http://www.w3.org/2000/svg">
                   <path d="M80.5 3L81.7348 7.1459H85.7308L82.498 9.7082L83.7328 13.8541L80.5 11.2918L77.2672 13.8541L78.502 9.7082L75.2692 7.1459H79.2652L80.5 3Z" fill="#FBBCA2"/>
                   <path d="M97 7L98.1226 10.1094H101.755L98.8164 12.0312L99.9389 15.1406L97 13.2188L94.0611 15.1406L95.1836 12.0312L92.2447 10.1094H95.8774L97 7Z" fill="#FBBCA2" fill-opacity="0.8"/>
                   <path d="M109 11L109.898 13.7639H112.804L110.453 15.4721L111.351 18.2361L109 16.5279L106.649 18.2361L107.547 15.4721L105.196 13.7639H108.102L109 11Z" fill="#FBBCA2" fill-opacity="0.5"/>
                   <path d="M49.5 11L50.2858 13.7639H52.8287L50.7714 15.4721L51.5572 18.2361L49.5 16.5279L47.4428 18.2361L48.2286 15.4721L46.1713 13.7639H48.7142L49.5 11Z" fill="#FBBCA2" fill-opacity="0.5"/>
                   <path d="M64.5 7L65.5103 10.1094H68.7798L66.1347 12.0312L67.145 15.1406L64.5 13.2188L61.855 15.1406L62.8653 12.0312L60.2202 10.1094H63.4897L64.5 7Z" fill="#FBBCA2" fill-opacity="0.8"/>
                   <path d="M8.29 36H1.7875V20.925H8.29C13.24 20.925 15.9625 23.6925 15.9625 28.4625C15.9625 33.2325 13.24 36 8.29 36ZM8.065 24.7275H6.0175V32.1975H8.065C10.72 32.1975 11.395 31.635 11.395 28.4625C11.395 25.29 10.72 24.7275 8.065 24.7275ZM21.7353 36H17.5278V24.435H21.4653V26.19H21.6678C22.3203 25.065 23.4228 24.21 24.9528 24.21C27.1803 24.21 27.9678 25.65 27.9678 27.9225V30.015H23.7378V28.8675C23.7378 28.0125 23.5803 27.765 22.7928 27.765C22.0953 27.765 21.7353 27.855 21.7353 28.6875V36ZM33.2376 23.4H29.0301V20.925H33.2376V23.4ZM33.2601 36H29.0301V24.435H33.2601V36ZM38.9986 36H35.0611V20.925H39.2686V25.965H39.4711C39.9661 24.9075 41.0911 24.21 42.7561 24.21C45.8161 24.21 47.4136 26.5725 47.4136 30.2175C47.4136 33.8625 45.7711 36.225 42.8461 36.225C40.9786 36.225 39.7636 35.505 39.1336 34.425H38.9986V36ZM39.2686 30.6225C39.2686 32.22 39.8986 32.535 41.2261 32.535C42.9811 32.535 43.2061 31.77 43.2061 30.2175C43.2061 28.665 43.0036 27.8775 41.2261 27.8775C39.8986 27.8775 39.2686 28.215 39.2686 29.79V30.6225ZM52.786 36H48.8485V20.925H53.056V25.965H53.2585C53.7535 24.9075 54.8785 24.21 56.5435 24.21C59.6035 24.21 61.201 26.5725 61.201 30.2175C61.201 33.8625 59.5585 36.225 56.6335 36.225C54.766 36.225 53.551 35.505 52.921 34.425H52.786V36ZM53.056 30.6225C53.056 32.22 53.686 32.535 55.0135 32.535C56.7685 32.535 56.9935 31.77 56.9935 30.2175C56.9935 28.665 56.791 27.8775 55.0135 27.8775C53.686 27.8775 53.056 28.215 53.056 29.79V30.6225ZM66.8434 36H62.6359V20.925H66.8434V36ZM74.1607 36.225C70.4032 36.225 68.2882 34.02 68.2882 30.33C68.2882 26.505 70.4482 24.21 74.2957 24.21C78.0307 24.21 79.8982 26.3925 79.8982 29.475C79.8982 30.105 79.7857 30.8025 79.7182 31.185H72.2257C72.2932 32.4225 72.6757 32.715 74.2282 32.715C75.2407 32.715 75.5782 32.5125 75.5782 31.995V31.95H79.7632V32.22C79.7632 34.56 77.6032 36.225 74.1607 36.225ZM74.0707 27.54C72.7657 27.54 72.2932 27.945 72.2257 28.89H75.8707C75.8482 28.1475 75.4657 27.54 74.0707 27.54ZM91.9144 36H85.4119V20.925H91.9144C96.8644 20.925 99.5869 23.6925 99.5869 28.4625C99.5869 33.2325 96.8644 36 91.9144 36ZM91.6894 24.7275H89.6419V32.1975H91.6894C94.3444 32.1975 95.0194 31.635 95.0194 28.4625C95.0194 25.29 94.3444 24.7275 91.6894 24.7275ZM105.404 23.4H101.196V20.925H105.404V23.4ZM105.426 36H101.196V24.435H105.426V36ZM111.664 34.56C108.446 34.56 106.826 32.58 106.826 29.4975C106.826 26.28 108.491 24.21 111.731 24.21C113.239 24.21 114.386 24.6825 115.106 25.8975H115.241V24.435H119.179V34.2C119.179 38.3175 117.154 40.05 113.171 40.05C109.481 40.05 107.366 38.385 107.366 35.1675H111.596C111.596 36.045 111.821 36.315 113.306 36.315C114.589 36.315 114.971 36.135 114.971 35.1V33.3H114.791C114.386 33.9525 113.351 34.56 111.664 34.56ZM111.034 29.4975C111.034 30.6225 111.326 31.2075 112.969 31.2075C114.409 31.2075 114.971 30.8925 114.971 29.745V29.2275C114.971 28.1025 114.431 27.765 113.036 27.765C111.371 27.765 111.034 28.3725 111.034 29.4975ZM126.442 36.225C122.685 36.225 120.57 34.02 120.57 30.33C120.57 26.505 122.73 24.21 126.577 24.21C130.312 24.21 132.18 26.3925 132.18 29.475C132.18 30.105 132.067 30.8025 132 31.185H124.507C124.575 32.4225 124.957 32.715 126.51 32.715C127.522 32.715 127.86 32.5125 127.86 31.995V31.95H132.045V32.22C132.045 34.56 129.885 36.225 126.442 36.225ZM126.352 27.54C125.047 27.54 124.575 27.945 124.507 28.89H128.152C128.13 28.1475 127.747 27.54 126.352 27.54ZM139.035 36.225C135.21 36.225 133.477 34.7175 133.477 32.085V32.0175H137.415V32.31C137.415 32.94 137.617 33.0975 139.035 33.0975C140.205 33.0975 140.317 32.985 140.317 32.5575C140.317 32.1975 140.205 32.085 139.237 31.905L137.032 31.5C134.737 31.0725 133.432 30.1725 133.432 27.9225C133.432 25.785 135.165 24.21 138.585 24.21C141.555 24.21 143.805 25.515 143.805 28.0575V28.485H139.845V28.2825C139.845 27.585 139.552 27.3825 138.472 27.3825C137.46 27.3825 137.325 27.585 137.325 27.9225C137.325 28.215 137.437 28.3725 138.18 28.53L140.767 29.07C143.355 29.61 144.232 30.6225 144.232 32.49C144.232 34.6725 142.432 36.225 139.035 36.225ZM150.848 36.225C147.721 36.225 146.258 34.965 146.258 32.175V27.9H144.728V24.435H146.393L147.136 22.05H150.488V24.435H153.548V27.9H150.488V31.545C150.488 32.2425 150.736 32.4225 151.703 32.4225H153.548V35.955C152.963 36.09 151.906 36.225 150.848 36.225Z" fill="white"/>
               </svg>
           </div>

           <!-- TODO headline link -->
           <a href="https://example.com" style="color: #fff; font-size: 2rem; font-weight: 800; text-align: center; display: block; text-decoration: none; margin: 4rem 4rem 0 4rem;">
               <!-- TODO headline -->
               "Josh Jacobs Rumors: Dolphins Inquired About Trade, Raiders Said RB Isn't Available"
           </a>

           <div style="display: flex; justify-content: center;">
               <div style="display: inline-block; width: 35px; height: 2px; background-color: #fff; border-radius: 10px; margin: 1rem 0 1rem 0;">

               </div>
           </div>

           <p style="color: #B4B6BB; font-size: .8rem; font-weight: 400; text-align: center; margin: 0;">
               <!-- TODO date -->
               Friday, August 25, 2023
           </p>

           <div style="margin: 4rem 4.5rem 0 4.5rem">
               <img style="width: 100%; height: auto; border-radius: 10px;" src="https://media.bleacherreport.com/image/upload/w_800,h_533,c_fill/v1692882843/tooaszoxs90ozmja1yvh.jpg" alt="Headline image">
           </div>

           <div style="display: flex; margin-top: 4rem;">
               <div style="width: 4rem;">

               </div>

               <div style="flex-grow: 1;">
                   <p style="color: #fff; font-size: 2rem; font-weight: 800; text-align: center; display: block; text-decoration: none; margin: 2rem 4rem 0 4rem;">
                       Betting Lines
                   </p>

                   <div style="height: 10rem;">

                   </div>
               </div>

               <div style="width: 4rem;">

               </div>
           </div>
       </div>
       </body>
</html>
"""

    message = MIMEMultipart("alternative")
    message["Subject"] = "Today's Digest"
    message["From"] = 'dribbledigest1@gmail.com'
    message["To"] = email

    message.attach(MIMEText(html, "html"))

    server.sendmail(from_addr='dribbledigest1@gmail.com', to_addrs=[email], msg=message.as_string())

def main():
    send_digest('extraneousprofiles@gmail.com')

if __name__ == "__main__":
    main()